<!DOCTYPE html><html lang=en><meta http-equiv=Content-Type content="text/html;charset=utf-8"> <meta http-equiv=X-UA-Compatible content="IE=edge"> <meta name=viewport content="width=device-width, initial-scale=1"><title>Lab 4: MIPS Array</title><meta name=description content="Lab 4: MIPS Array Due: Sunday, April 10 at 23:59"> <link rel=canonical href=https://checkoway.net/teaching/cs210/2022-spring/labs/lab4.html> <link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css integrity=sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei crossorigin=anonymous> <link rel=stylesheet href=/css/main.css><main><h1 id=lab-4-mips-array>Lab 4: MIPS Array</h1><p><strong>Due: Sunday, April 10 at 23:59</strong><section><p>Your task is to write a program to read a list of <code class="language-plaintext highlighter-rouge">(x,y)</code> pairs representing points in the xy-plane and print them in ascending order, according to their distance from the origin. You will write this program in MIPS using the <a href=https://courses.missouristate.edu/KenVollmar/mars/download.htm>MARS</a> simulator<h2 id=preliminaries>Preliminaries</h2><p><strong>Click on the <a href=https://classroom.github.com/a/rKSo7Bi5>assignment link</a>.</strong><p>Once you have accepted the assignment, you can clone the repository on your computer by following the instruction and begin working.<p>Be sure to ask any questions on <a href=https://piazza.com/oberlin/spring2022/cs210/home>Piazza</a>.</section><section><h2 id=program-specification>Program specification</h2><p>No starter code is provided this time. Create a file in MARS called <code class="language-plaintext highlighter-rouge">lab4.asm</code> and create your program there. You may wish to look at your code for <a href=lab3.html>Lab 3</a> for reference.<h3 id=input>Input</h3><p>The first line of input is an integer <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.43056em></span><span class="strut bottom" style=height:0.43056em;vertical-align:0em></span><span class=base><span class="mord mathit">n</span></span></span></span> (<span class=katex><span class=katex-mathml><math><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mn>1</mn><mn>0</mn><mn>0</mn><mn>0</mn></mrow><annotation encoding=application/x-tex>1 \leq n \leq 1000</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.64444em></span><span class="strut bottom" style=height:0.78041em;vertical-align:-0.13597em></span><span class=base><span class=mord>1</span><span class="mord rule" style=margin-right:0.2777777777777778em></span><span class=mrel>≤</span><span class="mord rule" style=margin-right:0.2777777777777778em></span><span class="mord mathit">n</span><span class="mord rule" style=margin-right:0.2777777777777778em></span><span class=mrel>≤</span><span class="mord rule" style=margin-right:0.2777777777777778em></span><span class=mord>1</span><span class=mord>0</span><span class=mord>0</span><span class=mord>0</span></span></span></span>) representing the number of points in the list. <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.43056em></span><span class="strut bottom" style=height:0.43056em;vertical-align:0em></span><span class=base><span class="mord mathit">n</span></span></span></span> is followed by <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>2</mn><mi>n</mi></mrow><annotation encoding=application/x-tex>2n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.64444em></span><span class="strut bottom" style=height:0.64444em;vertical-align:0em></span><span class=base><span class=mord>2</span><span class="mord mathit">n</span></span></span></span> additional lines of input containing the coordinates of the points to be sorted. For example, the list <span class=katex><span class=katex-mathml><math><semantics><mrow><mo>{</mo><mo>(</mo><mn>3</mn><mo separator=true>,</mo><mn>4</mn><mo>)</mo><mo separator=true>,</mo><mo>(</mo><mn>4</mn><mo separator=true>,</mo><mn>2</mn><mo>)</mo><mo separator=true>,</mo><mo>(</mo><mn>0</mn><mo separator=true>,</mo><mo>−</mo><mn>5</mn><mo>)</mo><mo separator=true>,</mo><mo>(</mo><mn>1</mn><mo separator=true>,</mo><mn>3</mn><mo>)</mo><mo>}</mo></mrow><annotation encoding=application/x-tex>\{ (3,4), (4,2), (0,-5), (1,3) \}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.75em></span><span class="strut bottom" style=height:1em;vertical-align:-0.25em></span><span class=base><span class=mopen>{</span><span class=mopen>(</span><span class=mord>3</span><span class=mpunct>,</span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mord>4</span><span class=mclose>)</span><span class=mpunct>,</span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mopen>(</span><span class=mord>4</span><span class=mpunct>,</span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mord>2</span><span class=mclose>)</span><span class=mpunct>,</span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mopen>(</span><span class=mord>0</span><span class=mpunct>,</span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mord>−</span><span class=mord>5</span><span class=mclose>)</span><span class=mpunct>,</span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mopen>(</span><span class=mord>1</span><span class=mpunct>,</span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mord>3</span><span class=mclose>)</span><span class=mclose>}</span></span></span></span> would be input as:<div class="language-plaintext highlighter-rouge"><div class=highlight><pre class=highlight><code>4
3
4
4
2
0
-5
1
3
</code></pre></div></div><p>You can read the values using system call 5 (read integer). (System call 5 requires that only one integer appear on each line.)<p>The input should be stored in an array. You can view the storage conceptually as a series of pairs, as shown below.<div class="language-plaintext highlighter-rouge"><div class=highlight><pre class=highlight><code>3  4
4  2
0 -5
1  3
</code></pre></div></div><h3 id=output>Output</h3><p>The output of the program will consist of <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.43056em></span><span class="strut bottom" style=height:0.43056em;vertical-align:0em></span><span class=base><span class="mord mathit">n</span></span></span></span> lines, each containing the x- and y-coordinates of one point in the sorted list. For example, the output from the list of 4 points shown above would be the following.<div class="language-plaintext highlighter-rouge"><div class=highlight><pre class=highlight><code>1    3
4    2
0    -5
3    4
</code></pre></div></div><h3 id=implementation>Implementation</h3><p>You will need to<ul><li>allocate space for the data;<li>decide how to map the data to the space you allocate; and<li>determine how to address the x- and y-coordinates of each point.</ul><p>Once you have read in all the data, you need to sort it in increasing order according to the value of <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup></mrow><annotation encoding=application/x-tex>x^2 + y^2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.8141079999999999em></span><span class="strut bottom" style=height:1.008548em;vertical-align:-0.19444em></span><span class=base><span class=mord><span class="mord mathit">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141079999999999em><span style=top:-3.063em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord rule" style=margin-right:0.2222222222222222em></span><span class=mbin>+</span><span class="mord rule" style=margin-right:0.2222222222222222em></span><span class=mord><span class="mord mathit" style=margin-right:0.03588em>y</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141079999999999em><span style=top:-3.063em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>; that is, the square of the distance from the point to the origin. If two points in your list are the same distance from the origin, they should be sorted in lexicographic order; that is, first in increasing order according to the x-coordinate, and if the x-coordinates are the same, then according to the y-coordinate. If the same point appears more than once in the input, it should appear with the same multiplicity in the output. For example, the correct ordering of the points <span class=katex><span class=katex-mathml><math><semantics><mrow><mo>(</mo><mn>0</mn><mo separator=true>,</mo><mo>−</mo><mn>5</mn><mo>)</mo></mrow><annotation encoding=application/x-tex>(0,-5)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.75em></span><span class="strut bottom" style=height:1em;vertical-align:-0.25em></span><span class=base><span class=mopen>(</span><span class=mord>0</span><span class=mpunct>,</span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mord>−</span><span class=mord>5</span><span class=mclose>)</span></span></span></span>, <span class=katex><span class=katex-mathml><math><semantics><mrow><mo>(</mo><mn>3</mn><mo separator=true>,</mo><mn>4</mn><mo>)</mo></mrow><annotation encoding=application/x-tex>(3,4)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.75em></span><span class="strut bottom" style=height:1em;vertical-align:-0.25em></span><span class=base><span class=mopen>(</span><span class=mord>3</span><span class=mpunct>,</span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mord>4</span><span class=mclose>)</span></span></span></span>, <span class=katex><span class=katex-mathml><math><semantics><mrow><mo>(</mo><mn>4</mn><mo separator=true>,</mo><mo>−</mo><mn>3</mn><mo>)</mo></mrow><annotation encoding=application/x-tex>(4,-3)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.75em></span><span class="strut bottom" style=height:1em;vertical-align:-0.25em></span><span class=base><span class=mopen>(</span><span class=mord>4</span><span class=mpunct>,</span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mord>−</span><span class=mord>3</span><span class=mclose>)</span></span></span></span>, <span class=katex><span class=katex-mathml><math><semantics><mrow><mo>(</mo><mo>−</mo><mn>3</mn><mo separator=true>,</mo><mn>4</mn><mo>)</mo></mrow><annotation encoding=application/x-tex>(-3,4)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.75em></span><span class="strut bottom" style=height:1em;vertical-align:-0.25em></span><span class=base><span class=mopen>(</span><span class=mord>−</span><span class=mord>3</span><span class=mpunct>,</span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mord>4</span><span class=mclose>)</span></span></span></span>, <span class=katex><span class=katex-mathml><math><semantics><mrow><mo>(</mo><mo>−</mo><mn>5</mn><mo separator=true>,</mo><mn>0</mn><mo>)</mo></mrow><annotation encoding=application/x-tex>(-5,0)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.75em></span><span class="strut bottom" style=height:1em;vertical-align:-0.25em></span><span class=base><span class=mopen>(</span><span class=mord>−</span><span class=mord>5</span><span class=mpunct>,</span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mord>0</span><span class=mclose>)</span></span></span></span> would be <span class=katex><span class=katex-mathml><math><semantics><mrow><mo>(</mo><mo>−</mo><mn>5</mn><mo separator=true>,</mo><mn>0</mn><mo>)</mo></mrow><annotation encoding=application/x-tex>(-5,0)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.75em></span><span class="strut bottom" style=height:1em;vertical-align:-0.25em></span><span class=base><span class=mopen>(</span><span class=mord>−</span><span class=mord>5</span><span class=mpunct>,</span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mord>0</span><span class=mclose>)</span></span></span></span>, <span class=katex><span class=katex-mathml><math><semantics><mrow><mo>(</mo><mo>−</mo><mn>3</mn><mo separator=true>,</mo><mn>4</mn><mo>)</mo></mrow><annotation encoding=application/x-tex>(-3,4)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.75em></span><span class="strut bottom" style=height:1em;vertical-align:-0.25em></span><span class=base><span class=mopen>(</span><span class=mord>−</span><span class=mord>3</span><span class=mpunct>,</span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mord>4</span><span class=mclose>)</span></span></span></span>, <span class=katex><span class=katex-mathml><math><semantics><mrow><mo>(</mo><mn>0</mn><mo separator=true>,</mo><mo>−</mo><mn>5</mn><mo>)</mo></mrow><annotation encoding=application/x-tex>(0,-5)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.75em></span><span class="strut bottom" style=height:1em;vertical-align:-0.25em></span><span class=base><span class=mopen>(</span><span class=mord>0</span><span class=mpunct>,</span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mord>−</span><span class=mord>5</span><span class=mclose>)</span></span></span></span>, <span class=katex><span class=katex-mathml><math><semantics><mrow><mo>(</mo><mn>3</mn><mo separator=true>,</mo><mn>4</mn><mo>)</mo></mrow><annotation encoding=application/x-tex>(3,4)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.75em></span><span class="strut bottom" style=height:1em;vertical-align:-0.25em></span><span class=base><span class=mopen>(</span><span class=mord>3</span><span class=mpunct>,</span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mord>4</span><span class=mclose>)</span></span></span></span>, <span class=katex><span class=katex-mathml><math><semantics><mrow><mo>(</mo><mn>4</mn><mo separator=true>,</mo><mo>−</mo><mn>3</mn><mo>)</mo></mrow><annotation encoding=application/x-tex>(4,-3)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.75em></span><span class="strut bottom" style=height:1em;vertical-align:-0.25em></span><span class=base><span class=mopen>(</span><span class=mord>4</span><span class=mpunct>,</span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mord>−</span><span class=mord>3</span><span class=mclose>)</span></span></span></span>.<p>You may use any sort method that you choose. I would recommend using something simple like <a href=https://en.wikipedia.org/wiki/Insertion_sort>insertion sort</a>. Keep in mind that when you swap two points in your list, you must swap both their x- and y-coordinates.<p>You may assume that overflow will not occur as a result of computing <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup></mrow><annotation encoding=application/x-tex>x^2 + y^2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.8141079999999999em></span><span class="strut bottom" style=height:1.008548em;vertical-align:-0.19444em></span><span class=base><span class=mord><span class="mord mathit">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141079999999999em><span style=top:-3.063em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord rule" style=margin-right:0.2222222222222222em></span><span class=mbin>+</span><span class="mord rule" style=margin-right:0.2222222222222222em></span><span class=mord><span class="mord mathit" style=margin-right:0.03588em>y</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141079999999999em><span style=top:-3.063em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>.<p><strong>For full points, you must structure your solution to use functions.</strong> See the next section for a suggested list of functions. Functions must be proper functions with arguments passed in the argument registers, results returned in the return registers, caller-saved registers that are used must be saved before use and restored before returning.<h3 id=suggested-plan-for-developing-the-program>Suggested plan for developing the program</h3><p>First, write and debug a program that will read <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.43056em></span><span class="strut bottom" style=height:0.43056em;vertical-align:0em></span><span class=base><span class="mord mathit">n</span></span></span></span> and the list of points, store each point in the array, and print it in the desired format.<p>After that, go back and add the sort operation. Make sure to test!<p>My solution consists of<ol><li>A <code class="language-plaintext highlighter-rouge">main</code> function that reads the number of points from the user, allocates enough space to hold the points (each point is two integers) and then calls three functions, <code class="language-plaintext highlighter-rouge">read_points</code>, <code class="language-plaintext highlighter-rouge">sort_points</code>, and <code class="language-plaintext highlighter-rouge">print_points</code>. It ends by calling the exit system call.<li>A <code class="language-plaintext highlighter-rouge">read_points</code> function that takes a pointer to the array of points and the number of points. In a loop, it reads the x- and y-coordinates for each point and stores them in the array.<li>A <code class="language-plaintext highlighter-rouge">sort_points</code> function that takes a pointer to the array of points and the number of points. I used one of the <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mi>n</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding=application/x-tex>O(n^2)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.8141079999999999em></span><span class="strut bottom" style=height:1.064108em;vertical-align:-0.25em></span><span class=base><span class="mord mathit" style=margin-right:0.02778em>O</span><span class=mopen>(</span><span class=mord><span class="mord mathit">n</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141079999999999em><span style=top:-3.063em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> sorting algorithms you learned about in 150 rather than something faster like Quicksort or Mergesort. The <code class="language-plaintext highlighter-rouge">sort_points</code> function needs to determine if one point is “smaller” than another. To that end, <code class="language-plaintext highlighter-rouge">sort_points</code> calls a <code class="language-plaintext highlighter-rouge">point_less_than</code> function whenever two points need to be compared. Many sorting algorithms are built on the idea of swapping two elements. I implemented a <code class="language-plaintext highlighter-rouge">swap</code> procedure which does that.<li><code class="language-plaintext highlighter-rouge">point_less_than</code> takes two pointers as arguments. The first pointer points to the first point and the second to the second point. Since each point is just two consecutive integers, if <code class="language-plaintext highlighter-rouge">p</code> were a pointer to a point, then (in C), <code class="language-plaintext highlighter-rouge">p[0]</code> is the x-coordinate and <code class="language-plaintext highlighter-rouge">p[1]</code> is the y-coordinate. In MIPS, since <code class="language-plaintext highlighter-rouge">$a0</code> will be the argument register holding the first pointer, we can access the x- and y-coordinates as follows. <pre><code class=language-asm>lw      $t0, 0($a0) # load the x-coordinate of the first point into $t0
lw      $t1, 4($a0) # load the y-coordinate of the first point into $t1
</code></pre><p><code class="language-plaintext highlighter-rouge">point_less_than</code> returns 1 if its first argument is less than its second; otherwise, it returns 0.<li>Like <code class="language-plaintext highlighter-rouge">point_less_than</code>, <code class="language-plaintext highlighter-rouge">swap</code> takes two pointers to points as arguments. It loads the four integers (two for each point), and then stores them in the appropriate location for the other point.<li>A <code class="language-plaintext highlighter-rouge">print_points</code> function which prints the points in a loop.</ol><p>Each of these 6 functions is a proper function meaning arguments are passed in <code class="language-plaintext highlighter-rouge">$a0</code> through <code class="language-plaintext highlighter-rouge">$a3</code> and the return value (if any) is in <code class="language-plaintext highlighter-rouge">$v0</code>. Proper stack manipulation was performed (reserving space on the sack for registers, including <code class="language-plaintext highlighter-rouge">$ra</code> in the prologue and cleaning it up in the epilogue).<p>You may initially find writing proper functions to be a hassle, but doing so will make your code vastly easier to read and reason about. And it’s required to get full points.<h2 id=helpful-resources>Helpful resources</h2><ul><li>A <a href=https://riptutorial.com/mips/example/29993/mars-mips-simulator>guide</a> to the MARS simulator<li>A <a href=https://courses.missouristate.edu/kenvollmar/mars/help/syscallhelp.html>list</a> of MIPS system calls</ul><h2 id=submission>Submission</h2><p>Submit the lab by committing your code and pushing it to your GitHub repository.</section></main>