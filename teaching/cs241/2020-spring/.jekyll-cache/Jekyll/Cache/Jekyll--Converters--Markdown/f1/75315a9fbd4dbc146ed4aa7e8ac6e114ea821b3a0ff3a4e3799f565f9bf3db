I"'<h1 id="lecture-10--feb-24th-2020">Lecture 10 – Feb 24th, 2020</h1>

<h2 id="setup">Setup</h2>
<ol>
  <li>Log in to clyde.</li>
  <li>Create a directory and <code class="highlighter-rouge">cd</code> into it.</li>
  <li>Copy <code class="highlighter-rouge">~steve/ex/rand.h</code> and <code class="highlighter-rouge">~steve/ex/rand.c</code> into the directory.</li>
</ol>

<h2 id="task">Task</h2>
<ol>
  <li>Take a look at <code class="highlighter-rouge">rand.h</code> and look at the function declared there. What
arguments does it take? What does it return?</li>
  <li>
    <p>Write a file <code class="highlighter-rouge">printfloat.c</code>. Include <code class="highlighter-rouge">rand.h</code> and <code class="highlighter-rouge">stdio.h</code>. Your <code class="highlighter-rouge">main</code>
function should call <code class="highlighter-rouge">random_value()</code> one time, storing the result in a
variable of type <code class="highlighter-rouge">double</code>. Print that value out three times using <code class="highlighter-rouge">printf</code>
with the <code class="highlighter-rouge">%e</code>, <code class="highlighter-rouge">%f</code>, and <code class="highlighter-rouge">%g</code> format specifiers.</p>

    <p>Compile the program using</p>
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ clang -std=c11 -Wall -o printfloat printfloat.c rand.c
</code></pre></div>    </div>
    <p>and then run it a few times. Do the printed values match what you expected?
If not, check out the man page for <code class="highlighter-rouge">printf(3)</code> (you’ll need to run <code class="highlighter-rouge">$ man 3
printf</code> because <code class="highlighter-rouge">printf(1)</code> is the manual page for the shell command
<code class="highlighter-rouge">printf</code> and we want the library function).</p>
  </li>
  <li>Modify <code class="highlighter-rouge">printfloat.c</code> to change the precision used to print the floats.
E.g., try <code class="highlighter-rouge">%.1e</code>, <code class="highlighter-rouge">%.2e</code>, <code class="highlighter-rouge">%.3e</code>. Recompile and run the program a few times
each.</li>
  <li>
    <p>Each time we recompile, we’re forcing the compiler to recompile <code class="highlighter-rouge">rand.c</code>
even though it hasn’t changed. This isn’t a big deal with such a small
program, but imagine a program with 100 files. This could take a long time
for each small change.</p>

    <p>Compile each of <code class="highlighter-rouge">printfloat.c</code> and <code class="highlighter-rouge">rand.c</code> separately and then link them
together.</p>
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ clang -std=c11 -Wall -c -o printfloat.o printfloat.c
$ clang -std=c11 -Wall -c -o rand.o rand.c
$ clang -o printfloat printfloat.o rand.o
</code></pre></div>    </div>
  </li>
  <li>Now modify <code class="highlighter-rouge">printfloat.c</code> in some way (any way you want), recompile just
<code class="highlighter-rouge">printfloat.o</code> and then do the final linking step.
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ clang -std=c11 -Wall -c -o printfloat.o printfloat.c
$ clang -o printfloat printfloat.o rand.o
</code></pre></div>    </div>
  </li>
  <li>
    <p>What do you think the average distance between two uniformly random numbers
in the range [0, 1] is? There are two ways we can figure this out. The hard
way: we could compute the integral
<script type="math/tex">\int_0^1\int_0^1|x-y|\,dx\,dy.</script></p>

    <p>But this isn’t calculus class, so let’s do it the easy way: Monte–Carlo
simulation. That’s just a fancy way of saying, let’s run a bunch of random
trials and see what we get on average.</p>

    <p>Write a new file <code class="highlighter-rouge">mc.c</code>. Include <code class="highlighter-rouge">rand.h</code> and <code class="highlighter-rouge">stdio.h</code> as before. Use
<code class="highlighter-rouge">#define</code> to define a constant <code class="highlighter-rouge">NUM_TRIALS</code>. E.g., something like</p>
    <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define NUM_TRIALS 10
</span></code></pre></div>    </div>

    <p>In the <code class="highlighter-rouge">main</code> function, define a variable <code class="highlighter-rouge">double total = 0.0;</code>. Next, loop
<code class="highlighter-rouge">NUM_TRIALS</code> times (a <code class="highlighter-rouge">for</code> loop works well here) and use <code class="highlighter-rouge">random_value()</code>
to get two random numbers <code class="highlighter-rouge">x</code> and <code class="highlighter-rouge">y</code>. Use the <code class="highlighter-rouge">fabs</code> function (read its
man page to see what header you need and how to call it) to compute the
absolute value of <code class="highlighter-rouge">x-y</code>. Add the result to <code class="highlighter-rouge">total</code>.</p>

    <p>After the loop, print out the average value of $|x-y|$ by dividing
<code class="highlighter-rouge">total</code> by <code class="highlighter-rouge">NUM_TRIALS</code>.</p>

    <p>Compile your program by compiling <code class="highlighter-rouge">mc.c</code> to <code class="highlighter-rouge">mc.o</code> and then linking <code class="highlighter-rouge">mc.o</code>
and <code class="highlighter-rouge">rand.o</code> as a program called <code class="highlighter-rouge">mc</code>. Run <code class="highlighter-rouge">./mc</code> a few times.</p>
  </li>
  <li>
    <p>Increase the value of <code class="highlighter-rouge">NUM_TRIALS</code> and recompile and run. Try the values
100, 1000, and 10000.</p>

    <p>Does the answer match what you’d expect? (I find it kind of surprising!)
Let’s double check our results by asking a <em>much</em> more complicated computer
program than the one we just wrote to work a lot harder and solve the
double integral above. Check out the result on
<a href="https://www.wolframalpha.com/input/?i=int+int+%7Cx+-+y%7C+dx+dy+x%3D0..1+y%3D0..1">Wolfram|Alpha</a>.</p>
  </li>
</ol>
:ET