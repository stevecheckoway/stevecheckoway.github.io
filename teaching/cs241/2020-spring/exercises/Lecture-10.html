<!DOCTYPE html><html lang=en><meta http-equiv=Content-Type content="text/html;charset=utf-8"> <meta http-equiv=X-UA-Compatible content="IE=edge"> <meta name=viewport content="width=device-width, initial-scale=1"><title>Lecture 10</title><meta name=description content="Lecture 10 – Feb 24th, 2020"> <link rel=canonical href=https://checkoway.net/teaching/cs241/2020-spring/exercises/Lecture-10.html> <link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css integrity=sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei crossorigin=anonymous> <link rel=stylesheet href=/css/main.css><main><h1 id=lecture-10--feb-24th-2020>Lecture 10 – Feb 24th, 2020</h1><h2 id=setup>Setup</h2><ol><li>Log in to clyde.<li>Create a directory and <code class="language-plaintext highlighter-rouge">cd</code> into it.<li>Copy <code class="language-plaintext highlighter-rouge">~steve/ex/rand.h</code> and <code class="language-plaintext highlighter-rouge">~steve/ex/rand.c</code> into the directory.</ol><h2 id=task>Task</h2><ol><li>Take a look at <code class="language-plaintext highlighter-rouge">rand.h</code> and look at the function declared there. What arguments does it take? What does it return?<li><p>Write a file <code class="language-plaintext highlighter-rouge">printfloat.c</code>. Include <code class="language-plaintext highlighter-rouge">rand.h</code> and <code class="language-plaintext highlighter-rouge">stdio.h</code>. Your <code class="language-plaintext highlighter-rouge">main</code> function should call <code class="language-plaintext highlighter-rouge">random_value()</code> one time, storing the result in a variable of type <code class="language-plaintext highlighter-rouge">double</code>. Print that value out three times using <code class="language-plaintext highlighter-rouge">printf</code> with the <code class="language-plaintext highlighter-rouge">%e</code>, <code class="language-plaintext highlighter-rouge">%f</code>, and <code class="language-plaintext highlighter-rouge">%g</code> format specifiers.<p>Compile the program using<div class="language-plaintext highlighter-rouge"><div class=highlight><pre class=highlight><code>$ clang -std=c11 -Wall -o printfloat printfloat.c rand.c
</code></pre></div></div><p>and then run it a few times. Do the printed values match what you expected? If not, check out the man page for <code class="language-plaintext highlighter-rouge">printf(3)</code> (you’ll need to run <code class="language-plaintext highlighter-rouge">$ man 3 printf</code> because <code class="language-plaintext highlighter-rouge">printf(1)</code> is the manual page for the shell command <code class="language-plaintext highlighter-rouge">printf</code> and we want the library function).<li>Modify <code class="language-plaintext highlighter-rouge">printfloat.c</code> to change the precision used to print the floats. E.g., try <code class="language-plaintext highlighter-rouge">%.1e</code>, <code class="language-plaintext highlighter-rouge">%.2e</code>, <code class="language-plaintext highlighter-rouge">%.3e</code>. Recompile and run the program a few times each.<li><p>Each time we recompile, we’re forcing the compiler to recompile <code class="language-plaintext highlighter-rouge">rand.c</code> even though it hasn’t changed. This isn’t a big deal with such a small program, but imagine a program with 100 files. This could take a long time for each small change.<p>Compile each of <code class="language-plaintext highlighter-rouge">printfloat.c</code> and <code class="language-plaintext highlighter-rouge">rand.c</code> separately and then link them together.<div class="language-plaintext highlighter-rouge"><div class=highlight><pre class=highlight><code>$ clang -std=c11 -Wall -c -o printfloat.o printfloat.c
$ clang -std=c11 -Wall -c -o rand.o rand.c
$ clang -o printfloat printfloat.o rand.o
</code></pre></div></div><li>Now modify <code class="language-plaintext highlighter-rouge">printfloat.c</code> in some way (any way you want), recompile just <code class="language-plaintext highlighter-rouge">printfloat.o</code> and then do the final linking step. <div class="language-plaintext highlighter-rouge"><div class=highlight><pre class=highlight><code>$ clang -std=c11 -Wall -c -o printfloat.o printfloat.c
$ clang -o printfloat printfloat.o rand.o
</code></pre></div></div><li><p>What do you think the average distance between two uniformly random numbers in the range [0, 1] is? There are two ways we can figure this out. The hard way: we could compute the integral <span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><mi mathvariant=normal>∣</mi><mi>x</mi><mo>−</mo><mi>y</mi><mi mathvariant=normal>∣</mi><mspace width=0.16667em></mspace><mi>d</mi><mi>x</mi><mspace width=0.16667em></mspace><mi>d</mi><mi>y</mi><mi mathvariant=normal>.</mi></mrow><annotation encoding=application/x-tex>\int_0^1\int_0^1|x-y|\,dx\,dy.</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:1.5640080000000003em></span><span class="strut bottom" style=height:2.4759580000000003em;vertical-align:-0.9119499999999999em></span><span class=base><span class=mop><span class="mop op-symbol large-op" style=margin-right:0.44445em;position:relative;top:-0.0011249999999999316em>∫</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.5640080000000003em><span style=top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style=top:-3.8129000000000004em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.9119499999999999em></span></span></span></span></span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mop><span class="mop op-symbol large-op" style=margin-right:0.44445em;position:relative;top:-0.0011249999999999316em>∫</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.5640080000000003em><span style=top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style=top:-3.8129000000000004em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.9119499999999999em></span></span></span></span></span><span class="mord rule" style=margin-right:0.16666666666666666em></span><span class=mord>∣</span><span class="mord mathit">x</span><span class="mord rule" style=margin-right:0.2222222222222222em></span><span class=mbin>−</span><span class="mord rule" style=margin-right:0.2222222222222222em></span><span class="mord mathit" style=margin-right:0.03588em>y</span><span class=mord>∣</span><span class="mspace thinspace"></span><span class="mord mathit">d</span><span class="mord mathit">x</span><span class="mspace thinspace"></span><span class="mord mathit">d</span><span class="mord mathit" style=margin-right:0.03588em>y</span><span class=mord>.</span></span></span></span></span><p>But this isn’t calculus class, so let’s do it the easy way: Monte–Carlo simulation. That’s just a fancy way of saying, let’s run a bunch of random trials and see what we get on average.<p>Write a new file <code class="language-plaintext highlighter-rouge">mc.c</code>. Include <code class="language-plaintext highlighter-rouge">rand.h</code> and <code class="language-plaintext highlighter-rouge">stdio.h</code> as before. Use <code class="language-plaintext highlighter-rouge">#define</code> to define a constant <code class="language-plaintext highlighter-rouge">NUM_TRIALS</code>. E.g., something like<div class="language-c highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=cp>#define NUM_TRIALS 10
</span></code></pre></div></div><p>In the <code class="language-plaintext highlighter-rouge">main</code> function, define a variable <code class="language-plaintext highlighter-rouge">double total = 0.0;</code>. Next, loop <code class="language-plaintext highlighter-rouge">NUM_TRIALS</code> times (a <code class="language-plaintext highlighter-rouge">for</code> loop works well here) and use <code class="language-plaintext highlighter-rouge">random_value()</code> to get two random numbers <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">y</code>. Use the <code class="language-plaintext highlighter-rouge">fabs</code> function (read its man page to see what header you need and how to call it) to compute the absolute value of <code class="language-plaintext highlighter-rouge">x-y</code>. Add the result to <code class="language-plaintext highlighter-rouge">total</code>.<p>After the loop, print out the average value of <span class=katex><span class=katex-mathml><math><semantics><mrow><mi mathvariant=normal>∣</mi><mi>x</mi><mo>−</mo><mi>y</mi><mi mathvariant=normal>∣</mi></mrow><annotation encoding=application/x-tex>|x-y|</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=strut style=height:0.75em></span><span class="strut bottom" style=height:1em;vertical-align:-0.25em></span><span class=base><span class=mord>∣</span><span class="mord mathit">x</span><span class="mord rule" style=margin-right:0.2222222222222222em></span><span class=mbin>−</span><span class="mord rule" style=margin-right:0.2222222222222222em></span><span class="mord mathit" style=margin-right:0.03588em>y</span><span class=mord>∣</span></span></span></span> by dividing <code class="language-plaintext highlighter-rouge">total</code> by <code class="language-plaintext highlighter-rouge">NUM_TRIALS</code>.<p>Compile your program by compiling <code class="language-plaintext highlighter-rouge">mc.c</code> to <code class="language-plaintext highlighter-rouge">mc.o</code> and then linking <code class="language-plaintext highlighter-rouge">mc.o</code> and <code class="language-plaintext highlighter-rouge">rand.o</code> as a program called <code class="language-plaintext highlighter-rouge">mc</code>. Run <code class="language-plaintext highlighter-rouge">./mc</code> a few times.<li><p>Increase the value of <code class="language-plaintext highlighter-rouge">NUM_TRIALS</code> and recompile and run. Try the values 100, 1000, and 10000.<p>Does the answer match what you’d expect? (I find it kind of surprising!) Let’s double check our results by asking a <em>much</em> more complicated computer program than the one we just wrote to work a lot harder and solve the double integral above. Check out the result on <a href="https://www.wolframalpha.com/input/?i=int+int+%7Cx+-+y%7C+dx+dy+x%3D0..1+y%3D0..1">Wolfram|Alpha</a>.</ol></main>