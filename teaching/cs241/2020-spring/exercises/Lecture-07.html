<!DOCTYPE html><html lang=en><meta http-equiv=Content-Type content="text/html;charset=utf-8"> <meta http-equiv=X-UA-Compatible content="IE=edge"> <meta name=viewport content="width=device-width, initial-scale=1"><title>Lecture 7</title><meta name=description content="Lecture 7 – Feb 17th, 2020"> <link rel=canonical href=https://checkoway.net/teaching/cs241/2020-spring/exercises/Lecture-07.html> <link rel=stylesheet href=/css/main.css><main><h1 id=lecture-7--feb-17th-2020>Lecture 7 – Feb 17th, 2020</h1><h2 id=setup>Setup</h2><ol><li>Log in to clyde.<li>Create a directory and <code class=highlighter-rouge>cd</code> into it.<li>Copy <code class=highlighter-rouge>~steve/ex/args</code> into the directory.</ol><h2 id=task>Task</h2><ol><li>Copy <code class=highlighter-rouge>args</code> to a new file <code class=highlighter-rouge>args2</code>. Modify <code class=highlighter-rouge>args2</code> so that your code is inside a function named <code class=highlighter-rouge>main</code>. After the function definition, call <code class=highlighter-rouge>main</code> as <div class="language-bash highlighter-rouge"><div class=highlight><pre class=highlight><code>main <span class=nv>$*</span>
</code></pre></div></div><p>and examine what happens when you run the script. In particular, compare to <code class=highlighter-rouge>args</code>. Replace <code class=highlighter-rouge>$*</code> with each of <code class=highlighter-rouge>$@</code>, <code class=highlighter-rouge>"$*"</code>, and <code class=highlighter-rouge>"$@"</code> and run the script after each modification. Make sure you understand the differences between the four. (Unquoted <code class=highlighter-rouge>$*</code> and <code class=highlighter-rouge>$@</code> should behave the same, but the others are different.)<li>Create a new script <code class=highlighter-rouge>architecture</code>. This script should iterate over each of its parameters and print out a friendly name for each computer architecture. If the architecture is not known, print it out verbatim. <div class=highlighter-rouge><div class=highlight><pre class=highlight><code>$ ./architecture i386 i486 i686 x86_64 m68k ppc armv6l armv6b \
  armv7l armv7b armv8l armv8b microblaze
Intel x86
Intel x86
Intel x86
AMD x86-64
Motorolla 68000
PowerPC
32-bit, Little-endian ARM
32-bit, Big-endian ARM
32-bit, Little-endian ARM
32-bit, Big-endian ARM
64-bit, Little-endian ARM
64-bit, Big-endian ARM
microblaze
</code></pre></div></div><p>(Here, <code class=highlighter-rouge>microblaze</code> isn’t known to the script so it printed it verbatim.) Use a <a href=https://www.gnu.org/software/bash/manual/html_node/Conditional-Constructs.html#index-case>case</a> statement rather than a series of <code class=highlighter-rouge>if</code>/<code class=highlighter-rouge>else</code> statements. Use patterns with wild cards to minimize the number of cases. In particular, the 32-bit Intel x86 and the 32-bit ARMs can be simplified.<li>The <code class=highlighter-rouge>uname</code> command will print a bunch of information about the current machine when given the appropriate options. In particular, <code class=highlighter-rouge>uname -m</code> will print out the current machine’s architecture. Try running <div class=highlighter-rouge><div class=highlight><pre class=highlight><code>$ ./architecture "$(uname -m)"
</code></pre></div></div><li>Run <code class=highlighter-rouge>shellcheck</code> on each of the scripts you created. Fix any warnings or errors.<li><p>Bash’s parameter expansion can actually do a lot more than expand variables to their values. Peruse <a href=https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html>the manual</a> and try out several of these in the shell.<p>In particular, <code class=highlighter-rouge>${var:-word}</code> and <code class=highlighter-rouge>${var-word}</code> will expand to either the value of the <code class=highlighter-rouge>var</code> variable or the expansion of <code class=highlighter-rouge>word</code> depending on whether <code class=highlighter-rouge>var</code> has been set (and is not empty, depending on using the colon or not).<p>For example, imagine printing a message using a variable <code class=highlighter-rouge>name</code> like this.<div class=highlighter-rouge><div class=highlight><pre class=highlight><code>$ echo "Hello ${name}"
</code></pre></div></div><p>Since <code class=highlighter-rouge>name</code> isn’t defined, it prints <code class=highlighter-rouge>Hello </code> (try it!). We can add a default value.<div class=highlighter-rouge><div class=highlight><pre class=highlight><code>$ echo "Hello ${name-${USER}}"
</code></pre></div></div><p>If <code class=highlighter-rouge>name</code> <em>is</em> defined, then it will print out <code class=highlighter-rouge>name</code> instead.<div class=highlighter-rouge><div class=highlight><pre class=highlight><code>$ name='Fatima'
$ echo "Hello ${name-${USER}}"
</code></pre></div></div><li><p>Substrings can be returned by using <code class=highlighter-rouge>${var:offset}</code> or <code class=highlighter-rouge>${var:offset:length}</code>. Set some variables and then print out their substrings.<p>Other useful expansions include <code class=highlighter-rouge>${var#word}</code>, <code class=highlighter-rouge>${var##word}</code>, <code class=highlighter-rouge>${var%word}</code>, <code class=highlighter-rouge>${var%%word}</code>, and <code class=highlighter-rouge>${var/pattern/string}</code>.<p>In new enough versions of Bash (like that on Clyde, but not on macOS by default), parameter expansion can change the case of characters. Look in the <a href=https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html>manual</a> to figure out how to print out the <code class=highlighter-rouge>USER</code> variable with just the first character changed to uppercase. Now, print out <code class=highlighter-rouge>USER</code> but with all characters changed to uppercase.</ol></main>