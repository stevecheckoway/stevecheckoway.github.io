<!DOCTYPE html><html lang=en><meta http-equiv=Content-Type content="text/html;charset=utf-8"> <meta name=viewport content="width=device-width, initial-scale=1"> <link rel=stylesheet href=/css/old-teaching.css type=text/css><title>Project 0</title><div id=layout-content><div id=toptitle><div id=title>Project 0</div></div><p><b>Due:</b> Tuesday, September 9, 2014, 23:59<br><h2>Goal</h2><p>The goal of this project is to become familiar with assembly language programming. This project will use 32-bit x86 assembly. Other projects will involve some subset of ARM, Thumb, and x86-64. Fortunately, once you become familiar with one assembly language, others are not too difficult.<h2>Collaboration</h2><p>You may work on this project in collaboration with a single partner as described on the <a href=index.html>main page</a>.<p>You must not discuss the project with anyone other than your partner and course staff. You may use online resources for general reference, but not to search for solutions to specific questions posed in this project.<h2>The Environment</h2><p>You (and we, for grading) will run your programs in a VirtualBox virtual machine. To use this VM on your personal computer (Windows, Mac OS&nbsp;X, and Linux are supported), you will need to download the virtual machine image provided on the course website (see Setting up the Environment below) as well as VirtualBox from the <a href=https://www.virtualbox.org/wiki/Downloads>VirtualBox website</a>.<p>The VM has Ubuntu installed as well as a number of useful utilities such as <code>vim</code>, <code>ssh</code>, and <code>wget</code>.<h2>The Assignment</h2><p>You are going to implement functions that operate on unsigned <a href=https://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic>big nums</a>. You have to implement the five functions described in bn.h in 32-bit x86 assembly in the file bn.s.<p>Some stubs have been provided so that the initial code will compile but will not run correctly.<h2>Deliverables</h2><p>You will use Blackboard to turn in a single file <code>bn.s</code> containing all of your code and writeup. In particular, this means that you cannot modify any of the other files since we will be using our own version to test your code.<p>You may wish to add additional tests in <code>main.c</code> to check that your code works properly. We will test using a more extensive test suite.<p>At the top of <code>bn.s</code> add a comment with the names of everyone in your group. Additionally, for each function that you write (including any helpers you produce), add a comment describing what the function does, what its parameters are, and (briefly) how it works. <b>This is required. Failure to do so will result in lost points.</b><h2>Hints</h2><ol><li><p><code>gcc -m32 -S</code> is your friend! If you run that on a C file, it will produce assembly.<li><p>You should look at how <code>gcc</code> emits code for function calls and make sure you follow suit. See <a href=https://en.wikipedia.org/wiki/X86_calling_conventions>Wikipedia</a> for details on stack alignment and the x86 cdecl calling convention used by Linux.<li><p>You can get <code>gcc</code> to use Intel syntax (instead of AT&amp;T) for x86 with <code>gcc -S -masm=intel</code>.<li><p>For bn_hex2bn, a helper function that converts a single hex digit to an int can be very useful.<li><p>The standard library function isxdigit() can be helpful as well.<li><p>Several functions require ensuring that the bn has enough limbs. This can also be factored out into a helper function.<li><p>When adding numbers, you'll want to use the <code>adc</code> instruction in a loop. The <code>clc</code> instruction can be used to clear the carry flag and the <code>loop</code> instruction can be used to decrement <code>ecx</code> and branch if nonzero without changing flags. Helpfully, <code>inc</code> and <code>dec</code> do <i>not</i> affect the carry flag.<li><p>You're likely going to want to have a copy of the Intel manuals for reference. (See Resources on the main course <a href=index.html>webpage</a>.)</ol><h2>Setting up the Environment</h2><p>On your own machine, you will need to install VirtualBox. Follow the instructions on the <a href=https://www.virtualbox.org/wiki/Downloads>VirtualBox webpage</a>. If you have trouble, read the documentation.<ol><li><p>Download the VM sandbox-1.1.ova (1.1&nbsp;GB).<li><p>From the <code>File</code> menu, choose the <code>Import Applianceâ€¦</code> menu option.<li><p>Open <code>sandbox-1.1.ova</code> and follow the steps to import.<li><p>In the main window, select the <code>sandbox-1.1</code> VM and start it by clicking on the <code>Start</code> button.<li><p>Log in to the VM. There is one account <code>user</code> with the password <code>user</code>. The <code>user</code> account can use the <code>sudo</code> command to run commands as root (or <code>sudo -s</code> to get a root shell) but that should not be needed for this project.<li><p>Download the project 0 tarball in the virtual machine.<br><code>wget https://www.cs.jhu.edu/~s/teaching/cs460/2014-fall/project0.tar.gz</code><li><p>Unpack <code>project0.tar.gz</code> and use the <code>Makefile</code> to build the code.<li><p>It is very useful to be able to <code>ssh</code> into the VM. You can forward a TCP port from your host machine to the VM using VirtualBox. Select the sandbox virtual machine and goto Settings &gt; Network &gt; Port Forwarding. The VM may already be configured to forward a port. The setting I use has protocol TCP, host port 2222, and guest port 22. On my host machine, I have the following lines in my <code>$HOME/.ssh/config</code> file so that I can ssh to the VM by running <code>ssh sandbox</code>:</ol><div class=codeblock><div class=blockcontent><pre>Host = sandbox
HostName = localhost
Port = 2222
User = user
</pre></div></div><div id=footer><div id=footer-text>Last updated 2016-06-28 11:50:21 CDT.</div></div></div>