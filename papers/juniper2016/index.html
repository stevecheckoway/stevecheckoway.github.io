<!DOCTYPE html><html lang=en><meta http-equiv=Content-Type content="text/html;charset=utf-8"> <meta http-equiv=X-UA-Compatible content="IE=edge"> <meta name=viewport content="width=device-width, initial-scale=1"><title>A Systematic Analysis of the Juniper Dual EC Incident</title><meta name=description content="In Proceedings of CCS 2016. ACM Press, October 2016."> <link rel=canonical href=https://checkoway.net/papers/juniper2016/> <link rel=stylesheet href=/css/main.css> <script>!function(e,t,a,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=t.createElement(a),s=t.getElementsByTagName(a)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-34500030-2","auto"),ga("send","pageview")</script><main><article vocab=http://schema.org typeof=ScholarlyArticle resource=juniper2016.pdf><h1 class=paper-title property=headline>A Systematic Analysis of the Juniper Dual EC Incident</h1><p>By <span property=author typeof=Person><span property=name><a href=https://checkoway.net property=url>Stephen Checkoway</a></span></span>, <span property=author typeof=Person><span property=name><a href=https://jakemask.com/ property=url>Jake Maskiewicz</a></span></span>, <span property=author typeof=Person><span property=name><a href=https://cs.jhu.edu/~cgarman/ property=url>Christina Garman</a></span></span>, <span property=author typeof=Person><span property=name>Joshua Fried</span></span>, <span property=author typeof=Person><span property=name><a href=https://cohney.info/ property=url>Shaanan Cohney</a></span></span>, <span property=author typeof=Person><span property=name><a href=http://spar.isi.jhu.edu/~mgreen/ property=url>Matthew Green</a></span></span>, <span property=author typeof=Person><span property=name><a href=https://www.cis.upenn.edu/~nadiah/ property=url>Nadia Heninger</a></span></span>, <span property=author typeof=Person><span property=name>Ralf-Philipp Weinmann</span></span>, <span property=author typeof=Person><span property=name><a href=http://www.rtfm.com property=url>Eric Rescorla</a></span></span>, and <span property=author typeof=Person><span property=name><a href=https://www.cs.utexas.edu/~hovav/ property=url>Hovav Shacham</a></span></span>.<p>In <em>Proceedings of CCS 2016</em>. ACM Press, October 2016.<h2 id=abstract>Abstract</h2><p>In December 2015, Juniper Networks announced multiple security vulnerabilities stemming from unauthorized code in ScreenOS, the operating system for their NetScreen VPN routers. The more sophisticated of these vulnerabilities was a passive VPN decryption capability, enabled by a change to one of the elliptic curve points used by the Dual EC pseudorandom number generator.<p>In this paper, we describe the results of a full independent analysis of the ScreenOS randomness and VPN key establishment protocol subsystems, which we carried out in response to this incident. While Dual EC is known to be insecure against an attacker who can choose the elliptic curve parameters, Juniper had claimed in 2013 that ScreenOS included countermeasures against this type of attack. We find that, contrary to Juniper’s public statements, the ScreenOS VPN implementation has been vulnerable since 2008 to passive exploitation by an attacker who selects the Dual EC curve point. This vulnerability arises due to apparent flaws in Juniper’s countermeasures as well as a cluster of changes that were all introduced concurrently with the inclusion of Dual EC in a single 2008 release. We demonstrate the vulnerability on a real NetScreen device by modifying the firmware to install our own parameters, and we show that it is possible to passively decrypt an individual VPN session in isolation without observing any other network traffic. We investigate the possibility of passively fingerprinting ScreenOS implementations in the wild. This incident is an important example of how guidelines for random number generation, engineering, and validation can fail in practice.<h2 id=material>Material</h2><ul><li>Full version, local copy in <a href=juniper2016.pdf>PDF</a>.<li>Talk slides in <a href=juniper2016-slides.pdf>PDF</a>.</ul><h2 id=reference>Reference</h2><pre><code class=language-bibtex>@InProceedings{checkoway-et-al:juniper-dual-ec:ccs16,
        author =        {Stephen Checkoway and Jacob Maskiewicz and Christina
                         Garman and Joshua Fried and Shaanan Cohney and
                         Matthew Green and Nadia Heninger and Ralf-Philipp
                         Weinmann and Eric Rescorla and Hovav Shacham},
        title =         {A Systematic Analysis of the Juniper Dual EC Incident},
        booktitle =     {Proceedings of CCS 2016},
        editor =        {Christopher Kruegel and Andrew Myers and Shai Halevi},
        year =          2016,
        month =         oct,
	url =           {https://checkoway.net/papers/juniper2016},
}
</code></pre></article></main>