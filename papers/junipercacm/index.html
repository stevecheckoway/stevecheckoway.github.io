<!DOCTYPE html><html lang=en><meta http-equiv=Content-Type content="text/html;charset=utf-8"> <meta http-equiv=X-UA-Compatible content="IE=edge"> <meta name=viewport content="width=device-width, initial-scale=1"><title>Where Did I Leave My Keys? Lessons from the Juniper Dual EC Incident</title><meta name=description content="In Communications of the ACM, 61(11):148–155, October 2016."> <link rel=canonical href=https://checkoway.net/papers/junipercacm/> <link rel=stylesheet href=/css/main.css> <script>!function(e,t,a,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=t.createElement(a),s=t.getElementsByTagName(a)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-34500030-2","auto"),ga("send","pageview")</script><main><article vocab=http://schema.org typeof=ScholarlyArticle resource=junipercacm.pdf><h1 class=paper-title property=headline>Where Did I Leave My Keys? Lessons from the Juniper Dual EC Incident</h1><p>By <span property=author typeof=Person><span property=name><a href=https://checkoway.net property=url>Stephen Checkoway</a></span></span>, <span property=author typeof=Person><span property=name><a href=https://jakemask.com/ property=url>Jake Maskiewicz</a></span></span>, <span property=author typeof=Person><span property=name><a href=https://cs.jhu.edu/~cgarman/ property=url>Christina Garman</a></span></span>, <span property=author typeof=Person><span property=name>Joshua Fried</span></span>, <span property=author typeof=Person><span property=name><a href=https://cohney.info/ property=url>Shaanan Cohney</a></span></span>, <span property=author typeof=Person><span property=name><a href=http://spar.isi.jhu.edu/~mgreen/ property=url>Matthew Green</a></span></span>, <span property=author typeof=Person><span property=name><a href=https://www.cis.upenn.edu/~nadiah/ property=url>Nadia Heninger</a></span></span>, <span property=author typeof=Person><span property=name>Ralf-Philipp Weinmann</span></span>, <span property=author typeof=Person><span property=name><a href=http://www.rtfm.com property=url>Eric Rescorla</a></span></span>, and <span property=author typeof=Person><span property=name><a href=https://www.cs.utexas.edu/~hovav/ property=url>Hovav Shacham</a></span></span>.<p>In <em>Communications of the ACM</em>, 61(11):148–155, October 2016.<h2 id=abstract>Abstract</h2><p>In December 2015, Juniper Networks announced multiple security vulnerabilities stemming from unauthorized code in ScreenOS, the operating system for their NetScreen Virtual Private Network (VPN) routers. The more sophisticated of these vulnerabilities was a passive VPN decryption capability, enabled by a change to one of the parameters used by the Dual Elliptic Curve (EC) pseudorandom number generator.<p>In this paper, we described the results of a full independent analysis of the ScreenOS randomness and VPN key establishment protocol subsystems, which we carried out in response to this incident. While Dual EC is known to be insecure against an attacker who can choose the elliptic curve parameters, Juniper had claimed in 2013 that ScreenOS included countermeasures against this type of attack. We find that, contrary to Juniper’s public statements, the ScreenOS VPN implementation has been vulnerable to passive exploitation by an attacker who selects the Dual EC curve point since 2008. This vulnerability arises due to flaws in Juniper’s countermeasures as well as a cluster of changes that were all introduced concurrently with the inclusion of Dual EC in a single 2008 release. We demonstrate the vulnerability on a real NetScreen device by modifying the firmware to install our own parameters, and we show that it is possible to passively decrypt an individual VPN session in isolation without observing any other network traffic. This incident is an important example of how guidelines for random number generation, engineering, and validation can fail in practice. Additionally, it casts further doubt on the practicality of designing a safe “exceptional access” or “key escrow” scheme of the type contemplated by law enforcement agencies in the United States and elsewhere.<h2 id=material>Material</h2><ul><li>CACM <a href=https://cacm.acm.org/magazines/2018/11/232227-where-did-i-leave-my-keys/>version</a>.<li>Authors’ version in <a href=junipercacm.pdf>PDF</a>.<li>Associated research <a href=/papers/juniper2016/>paper</a></ul><h2 id=reference>Reference</h2><pre><code class=language-bibtex>@Article{checkoway-et-al:juniper-dual-ec:cacm,
        author =        {Stephen Checkoway and Jacob Maskiewicz and Christina
                         Garman and Joshua Fried and Shaanan Cohney and
                         Matthew Green and Nadia Heninger and Ralf-Philipp
                         Weinmann and Eric Rescorla and Hovav Shacham},
	title =		{Where Did {I} Leave My Keys? {Lessons} from the
	   		 {Juniper} {Dual~EC} Incident},
	journal =	{Communications of the ACM},
	volume =	61,
	number =	11,
	month =		oct,
	year =		2018,
	issn =		{0001-0782},
	pages =		{148-155},
	publisher =	{ACM},
	url =           {https://checkoway.net/papers/junipercacm},
}
</code></pre></article></main>