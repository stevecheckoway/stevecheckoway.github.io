<!DOCTYPE html><html lang=en><meta http-equiv=Content-Type content="text/html;charset=utf-8"> <meta http-equiv=X-UA-Compatible content="IE=edge"> <meta name=viewport content="width=device-width, initial-scale=1"><title>Enforcing Forward-Edge Control-Flow Integrity in GCC &amp; LLVM</title><meta name=description content="In Proceedings of USENIX Security 2014. USENIX, August 2014."> <link rel=canonical href=https://checkoway.net/papers/fcfi2014/> <link rel=stylesheet href=/css/main.css><main><article vocab=http://schema.org typeof=ScholarlyArticle resource=fcfi2014.pdf><h1 class=paper-title property=headline>Enforcing Forward-Edge Control-Flow Integrity in GCC &amp; LLVM</h1><p>By <span property=author typeof=Person><span property=name><a href=http://research.google.com/pubs/CarolineTice.html property=url>Caroline Tice</a></span></span>, <span property=author typeof=Person><span property=name><a href=https://1.37e2.net/ property=url>Tom Roeder</a></span></span>, <span property=author typeof=Person><span property=name>Peter Collingbourne</span></span>, <span property=author typeof=Person><span property=name><a href=https://checkoway.net property=url>Stephen Checkoway</a></span></span>, <span property=author typeof=Person><span property=name><a href=http://research.google.com/pubs/ulfar.html property=url>Ãšlfar Erlingsson</a></span></span>, <span property=author typeof=Person><span property=name>Luis Lozano</span></span>, and <span property=author typeof=Person><span property=name><a href=http://research.google.com/pubs/GeoffPike.html property=url>Geoff Pike</a></span></span>.<p>In <i>Proceedings of USENIX Security 2014</i>. USENIX, August 2014.<h2 id=abstract>Abstract</h2><p>Constraining dynamic control transfers is a common technique for mitigating software vulnerabilities. This defense has been widely and successfully used to protect return addresses and stack data; hence, current attacks instead typically corrupt vtable and function pointers to subvert a forward edge (an indirect jump or call) in the control-flow graph. Forward edges can be protected using Control-Flow Integrity (CFI) but, to date, CFI im- plementations have been research prototypes, based on impractical assumptions or ad hoc, heuristic techniques. To be widely adoptable, CFI mechanisms must be integrated into production compilers and be compatible with software-engineering aspects such as incremental compilation and dynamic libraries.<p>This paper presents implementations of fine-grained, forward-edge CFI enforcement and analysis for GCC and LLVM that meet the above requirements. An analysis and evaluation of the security, performance, and resource consumption of these mechanisms applied to the SPEC CPU2006 benchmarks and common benchmarks for the Chromium web browser show the practicality of our approach: these fine-grained CFI mechanisms have significantly lower overhead than recent academic CFI prototypes. Implementing CFI in industrial compiler frameworks has also led to insights into design tradeoffs and practical challenges, such as dynamic loading.<h2 id=material>Material</h2><ul><li>Proceedings version in <a href=https://www.usenix.org/system/files/conference/usenixsecurity14/sec14-paper-tice.pdf>PDF</a>.<li>Slides from USENIX Security 2014 in <a href=https://www.usenix.org/sites/default/files/conference/protected-files/sec14_slides_tice.pdf>PDF</a><li>Full version, local copy in <a href=fcfi2014.pdf>PDF</a>.</ul><h2 id=reference>Reference</h2><div class="language-bibtex highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=nc>@InProceedings</span><span class=p>{</span><span class=nl>tice-et-al:fcfi:usenix14</span><span class=p>,</span>
	<span class=na>author</span> <span class=p>=</span>	<span class=s>{Caroline Tice and Tom Roeder and Peter Collingbourne
			 and Stephen Checkoway and Erlingsson, {\'U}lfar and
			 Luis Lozano and Geoff Pike}</span><span class=p>,</span>
	<span class=na>title</span> <span class=p>=</span>		<span class=s>{Enforcing Forward-Edge Control-Flow Integrity in
			 {GCC} \&amp; {LLVM}}</span><span class=p>,</span>
	<span class=na>booktitle</span> <span class=p>=</span>	<span class=s>{Proceedings of USENIX Security 2014}</span><span class=p>,</span>
	<span class=na>editor</span> <span class=p>=</span>	<span class=s>{Kevin Fu}</span><span class=p>,</span>
	<span class=na>publisher</span> <span class=p>=</span>	<span class=s>{USENIX}</span><span class=p>,</span>
	<span class=na>year</span> <span class=p>=</span>		<span class=m>2014</span><span class=p>,</span>
	<span class=na>month</span> <span class=p>=</span>		<span class=nv>aug</span><span class=p>,</span>
	<span class=na>url</span> <span class=p>=</span>           <span class=s>{https://checkoway.net/papers/fcfi2014}</span><span class=p>,</span>
<span class=p>}</span>
</code></pre></div></div></article></main>