<!DOCTYPE html><html lang=en><meta http-equiv=Content-Type content="text/html;charset=utf-8"> <meta http-equiv=X-UA-Compatible content="IE=edge"> <meta name=viewport content="width=device-width, initial-scale=1"><title>Jetset: Targeted Firmware Rehosting for Embedded Systems</title><meta name=description content="In Proceedings of USENIX SECURITY 2021. USENIX, August 2021."> <link rel=canonical href=https://checkoway.net/papers/jetset2021/> <link rel=stylesheet href=/css/main.css><main><article vocab=http://schema.org typeof=ScholarlyArticle resource=jetset2021.pdf><h1 class=paper-title property=headline>Jetset: Targeted Firmware Rehosting for Embedded Systems</h1><p>By <span property=author typeof=Person><span property=name><a href=https://cseweb.ucsd.edu/~e5johnso/ property=url>Evan Johnson</a></span></span>, <span property=author typeof=Person><span property=name><a href=https://bland.web.illinois.edu/ property=url>Maxwell Bland</a></span></span>, <span property=author typeof=Person><span property=name>YiFei Zhu</span></span>, <span property=author typeof=Person><span property=name>Joshua Mason</span></span>, <span property=author typeof=Person><span property=name><a href=https://checkoway.net property=url>Stephen Checkoway</a></span></span>, <span property=author typeof=Person><span property=name><a href=https://cseweb.ucsd.edu/~savage/ property=url>Stefan Savage</a></span></span>, and <span property=author typeof=Person><span property=name><a href=https://klevchen.ece.illinois.edu/ property=url>Kirill Levchenko</a></span></span>.<p>In <em>Proceedings of USENIX SECURITY 2021</em>. USENIX, August 2021.<h2 id=abstract>Abstract</h2><p>The ability to execute code in an emulator is a fundamental part of modern vulnerability testing. Unfortunately, this poses a challenge for many embedded systems, where firmware expects to interact with hardware devices specific to the target. Getting embedded system firmware to run outside its native environment, termed rehosting, requires emulating these hardware devices with enough accuracy to convince the firmware that it is executing on the target hardware. However, full fidelity emulation of target devices (which requires considerable engineering effort) may not be necessary to boot the firmware to a point of interest for an analyst (for example, a point where fuzzer input can be injected). We hypothesized that, for the firmware to boot successfully, it is sufficient to emulate only the behavior expected by the firmware, and that this behavior could be inferred automatically.<p>To test this hypothesis, we developed and implemented Jetset, a system that uses symbolic execution to infer what behavior firmware expects from a target device. Jetset can generate devices models for hardware peripherals in C, allowing an analyst to boot the firmware in an emulator (e.g., QEMU). We successfully applied Jetset to thirteen distinct pieces of firmware together representing three architectures, three application domains (power grid, avionics, and consumer electronics), and five different operating systems. We also demonstrate how Jetset-assisted rehosting facilitates fuzz-testing, a common security analysis technique, on an avionics embedded system, in which we found a previously unknown privilege escalation vulnerability.<h2 id=material>Material</h2><ul><li>Proceedings version <a href=https://www.usenix.org/system/files/sec21-johnson.pdf>PDF</a><li>Full version, local copy <a href=jetset2021.pdf>PDF</a></ul><h2 id=reference>Reference</h2><div class="language-bibtex highlighter-rouge"><div class=highlight><pre class=highlight><code><span class=nc>@InProceedings</span><span class=p>{</span><span class=nl>johnson-et-al:jetset:usenix21</span><span class=p>,</span>
  <span class=na>author</span> <span class=p>=</span>       <span class=s>{Evan Johnson and Maxwell Bland and YiFei Zhu and Joshua Mason
                  and Stephen Checkoway and Stefan Savage and Kirill Levchenko}</span><span class=p>,</span>
  <span class=na>title</span> <span class=p>=</span>        <span class=s>{Jetset: Targeted Firmware Rehosting for Embedded Systems}</span><span class=p>,</span>
  <span class=na>booktitle</span> <span class=p>=</span>    <span class=s>{Proceedings of the USENIX Security Symposium 2021,
                  (\textbf{USENIX})}</span><span class=p>,</span>
  <span class=na>editor</span> <span class=p>=</span>       <span class=s>{Michael Bailey and Rachel Greenstadt}</span><span class=p>,</span>
  <span class=na>year</span> <span class=p>=</span>         <span class=m>2021</span><span class=p>,</span>
  <span class=na>month</span> <span class=p>=</span>        <span class=nv>aug</span><span class=p>,</span>
  <span class=na>organization</span> <span class=p>=</span> <span class=s>{USENIX}</span><span class=p>,</span>
  <span class=na>url</span> <span class=p>=</span>          <span class=s>{https://checkoway.net/papers/jetset2021}</span><span class=p>,</span>
<span class=p>}</span>
</code></pre></div></div></article></main>